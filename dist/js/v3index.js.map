{"version":3,"sources":["../../src/js/ui/Boot.js","../../src/js/common/intro.js","../../src/js/ui/UI.js","../../src/js/ui/Event.js"],"names":["getEL","id","_doc","getElementById","customAttr","el","name","value","dataset","lowername","i","length","ch","charAt","toLowerCase","getAttribute","location","search","self","doclang","substr","href","match","testdoc","v3index","extend","onload_func","window","pzprfaq","input_init","parentNode","removeChild","style","display","Array","prototype","slice","call","querySelectorAll","forEach","typename","RegExp","$1","addEventListener","e","click_tab","setRecentPuzzle","disp_tab","setTranslation","translate","cnt","urlif","init","fileif","dbif","className","querySelector","set_puzzle_filter","isdisp","tablename","filtername","pid","pzpr","variety","toPID","tab","count","addPuzzle","pinfo","valid","createElement","innerHTML","listparent","appendChild","captions","push","anode","firstChild","str_jp","ja","str_en","en","JSON","parse","localStorage","recent","counts","sort","a","b","item","setlang","lang","setting","language","stringify","childNodes","state","this","obj","text","replace","body","n","_form","document","urlinput","url","open","fileform","filebox","fileinput","fileEL","FileReader","reader","onload","fileonload","target","result","readAsText","files","FileList","File","getAsText","reset","str","farray","split","fstr","list","DBlist","pheader","database","sorts_ja","sorts_en","datalist","select","open_ja","open_en","importlist","callback","data","row","pzl","parser","pdata","col","cols","rows","order","time","opt","setAttribute","getcaption","metadata","comtext","comment","author","source","width","datestr","ni","num","date","Date","setTime","getFullYear","getMonth","getDate","getHours","getMinutes","hard","selected","getvalue","val","pstate","lunch","testa","trial","lunch2","lunch3","nigun","omopa","orig","genre","add","tabstate","genres"],"mappings":"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","file":"v3index.js","sourcesContent":["// Boot.js v3.4.0\n/* jshint latedef:false */\n/* global ui:false, ActiveXObject:false */\n\n(function(){\n/********************************/\n/* 初期化時のみ使用するルーチン */\n/********************************/\n\nvar require_accesslog = true;\nvar onload_pzl = null;\nvar onload_option = {};\n\n//---------------------------------------------------------------------------\n// ★boot() window.onload直後の処理\n//---------------------------------------------------------------------------\npzpr.on('load', function boot(){\n\tif(importData() && includeDebugFile()){ startPuzzle();}\n\telse{ setTimeout(boot,0);}\n});\n\nfunction importData(){\n\tif(!onload_pzl){\n\t\t/* 1) 盤面複製・index.htmlからのファイル入力/Database入力か */\n\t\t/* 2) URL(?以降)をチェック */\n\t\tonload_pzl = (importFileData() || importURL());\n\t\t\n\t\t/* 指定されたパズルがない場合はさようなら～ */\n\t\tif(!onload_pzl || !onload_pzl.pid){ failOpen();}\n\t}\n\t\n\treturn true;\n}\n\nfunction failOpen(){\n\tif(!!ui.puzzle && !!ui.puzzle.pid){ return;}\n\tvar title2 = document.getElementById('title2');\n\tif(!!title2){ title2.innerHTML = \"Fail to import puzzle data or URL.\";}\n\tdocument.getElementById('menupanel').innerHTML = '';\n\t//throw new Error(\"No Include Puzzle Data Exception\");\n}\n\nfunction includeDebugFile(){\n\tvar pid = onload_pzl.pid, result = true;\n\t\n\t/* 必要な場合、テスト用ファイルのinclude         */\n\t/* importURL()後でないと必要かどうか判定できない */\n\tif(ui.debugmode){\n\t\tif(!ui.debug){\n\t\t\tresult = false;\n\t\t}\n\t\telse if(!ui.debug.urls){\n\t\t\tui.debug.includeDebugScript(\"for_test.js\");\n\t\t\tresult = false;\n\t\t}\n\t\telse if(!ui.debug.urls[pid]){\n\t\t\tui.debug.includeDebugScript(\"test_\"+pid+\".js\");\n\t\t\tresult = false;\n\t\t}\n\t}\n\t\n\treturn result;\n}\n\nfunction startPuzzle(){\n\tvar pzl = onload_pzl, pid = pzl.pid;\n\tif(ui.debugmode){ onload_option.mode = 'play';}\n\t\n\t/* IE SVGのtextLengthがうまく指定できていないので回避策を追加 */\n\tif((function(ua){ return ua.match(/MSIE/) || (ua.match(/AppleWebKit/) && ua.match(/Edge/));})(navigator.userAgent)){\n\t\tonload_option.graphic = 'canvas';\n\t}\n\t\n\t/* パズルオブジェクトの作成 */\n\tvar element = document.getElementById('divques');\n\tvar puzzle = ui.puzzle = new pzpr.Puzzle(element, onload_option);\n\tpzpr.connectKeyEvents(puzzle);\n\t\n\t/* パズルオブジェクト作成〜open()間に呼ぶ */\n\tui.event.onload_func();\n\t\n\t// 単体初期化処理のルーチンへ\n\tvar callback = null;\n\tif(!ui.debugmode){ callback = accesslog;}\n\telse{ puzzle.once('ready', function(puzzle){ ui.menuconfig.set('autocheck', true);});}\n\tif(!ui.debugmode && require_accesslog && onload_option.type!=='player'){ puzzle.once('ready', countpid);}\n\tpuzzle.once('fail-open', failOpen);\n\tpuzzle.open((!ui.debugmode || !!pzl.qdata) ? pzl : pid+\"/\"+ui.debug.urls[pid], callback);\n\t\n\treturn true;\n}\n\n//---------------------------------------------------------------------------\n// ★importURL() 初期化時にURLを解析し、パズルの種類・エディタ/player判定を行う\n//---------------------------------------------------------------------------\nfunction importURL(){\n\t/* index.htmlからURLが入力されたかチェック */\n\tvar search = getStorageData('pzprv3_urldata', 'urldata');\n\tif(!!search){ require_accesslog = false;}  /* index.htmlからのURL読み込み時はアクセスログをとらない */\n\t\n\t/* index.htmlからURLが入力されていない場合は現在のURLの?以降をとってくる */\n\tsearch = search || location.search;\n\tif(!search){ return null;}\n\t\n\t/* 一旦先頭の?記号を取り除く */\n\tif(search.charAt(0)===\"?\"){ search = search.substr(1);}\n\t\n\twhile(search.match(/^(\\w+)\\=(\\w+)\\&(.*)/)){\n\t\tonload_option[RegExp.$1] = RegExp.$2;\n\t\tsearch = RegExp.$3;\n\t}\n\t\n\t// エディタモードかplayerモードか、等を判定する\n\tif(search===\"test\"){ search = 'country_test';}\n\t\n\tvar startmode = '';\n\tif     (search.match(/_test/)){ startmode = 'EDITOR'; ui.debugmode = true;}\n\telse if(search.match(/^m\\+/)) { startmode = 'EDITOR';}\n\telse if(search.match(/_edit/)){ startmode = 'EDITOR';}\n\telse if(search.match(/_play/)){ startmode = 'PLAYER';}\n\tif(!require_accesslog){ startmode = 'EDITOR';}  /* index.htmlからの読み込み時はEDITORにする */\n\n\tsearch=search.replace(/^m\\+/,'');\n\tsearch=search.replace(/(_test|_edit|_play)/,'');\n\n\tvar pzl = pzpr.parser.parseURL(search);\n\n\tstartmode = startmode || (!pzl.body ? 'EDITOR' : 'PLAYER');\n\tif(startmode==='PLAYER'){ onload_option.type = 'player';}\n\n\treturn pzl;\n}\n\n//---------------------------------------------------------------------------\n// ★importFileData() 初期化時にファイルデータの読み込みを行う\n//---------------------------------------------------------------------------\nfunction importFileData(){\n\t/* index.htmlや盤面の複製等でファイルorブラウザ保存データが入力されたかチェック */\n\tvar fstr = getStorageData('pzprv3_filedata', 'filedata');\n\tif(!fstr){ return null;}\n\n\tvar pzl = pzpr.parser.parseFile(fstr, '');\n\tif(!pzl){ return null;}\n\n\trequire_accesslog = false;\n\t\n\treturn pzl;\n}\n\n//---------------------------------------------------------------------------\n// ★getStorageData() localStorageやsesseionStorageのデータを読み込む\n//---------------------------------------------------------------------------\nfunction getStorageData(key, key2){\n\t// 移し変える処理\n\tvar str = localStorage[key];\n\tif(typeof str===\"string\"){\n\t\tdelete localStorage[key];\n\t\tsessionStorage[key2] = str;\n\t}\n\n\tstr = sessionStorage[key2];\n\treturn (typeof str===\"string\" ? str : null);\n}\n\n//---------------------------------------------------------------------------\n// ★countpid() エディタとして開いた回数をログする\n//---------------------------------------------------------------------------\nfunction countpid(puzzle){\n\tvar counts = JSON.parse(localStorage['pzprv3_index:ranking']||'{}');\n\t\n\t// パズルの開いた数を記録\n\tvar count = counts.count || {};\n\tvar cnt = count[puzzle.pid] || 0;\n\tcount[puzzle.pid] = cnt + 1;\n\t\n\t// 最新10パズルを記録\n\tvar recent = counts.recent || [];\n\tif(recent.indexOf(puzzle.pid)>=0){ recent.splice(recent.indexOf(puzzle.pid),1);}\n\trecent.unshift(puzzle.pid);\n\tif(recent.length>10){ recent.pop();}\n\t\n\tlocalStorage['pzprv3_index:ranking'] = JSON.stringify({count:count,recent:recent});\n}\n\n//---------------------------------------------------------------------------\n// ★accesslog() playerのアクセスログをとる\n//---------------------------------------------------------------------------\nfunction accesslog(puzzle){\n\tif(!puzzle.playeronly || !onload_pzl.pid || !require_accesslog){ return;}\n\n\tif(document.domain!=='indi.s58.xrea.com' &&\n\t   document.domain!=='pzprv3.sakura.ne.jp' &&\n\t   !document.domain.match(/(dev\\.)?pzv\\.jp/)){ return;}\n\n\tvar refer = document.referrer;\n\tif(refer.match(/http\\:\\/\\/[\\w\\.]*pzv\\.jp/)){ return;}\n\n\trefer = refer.replace(/\\?/g,\"%3f\").replace(/\\&/g,\"%26\")\n\t\t\t\t .replace(/\\=/g,\"%3d\").replace(/\\//g,\"%2f\");\n\n\t// 送信\n\tvar xmlhttp = false;\n\tif(typeof ActiveXObject !== \"undefined\"){\n\t\ttry { xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");}\n\t\tcatch (e) { xmlhttp = false;}\n\t}\n\tif(!xmlhttp && typeof XMLHttpRequest !== \"undefined\") {\n\t\txmlhttp = new XMLHttpRequest();\n\t}\n\tif(xmlhttp){\n\t\tvar data = [\n\t\t\t(\"scr=\"     + \"pzprv3\"),\n\t\t\t(\"pid=\"     + onload_pzl.pid),\n\t\t\t(\"referer=\" + refer),\n\t\t\t(\"pzldata=\" + onload_pzl.qdata)\n\t\t].join('&');\n\n\t\txmlhttp.open(\"POST\", \"./record.cgi\");\n\t\txmlhttp.onreadystatechange = function(){};\n\t\txmlhttp.setRequestHeader(\"Content-Type\" , \"application/x-www-form-urlencoded\");\n\t\txmlhttp.send(data);\n\t}\n}\n\n})();\n","// intro.js\n\n(function(){\n","// UI.js v3.4.0\n/* global pzpr:false, ui:false, File:false */\n/* exported ui, _doc, getEL, createEL */\n\n/* ui.js Locals */\nvar _doc = document;\nfunction getEL(id){ return _doc.getElementById(id);}\nfunction createEL(tagName){ return _doc.createElement(tagName);}\n\n//---------------------------------------------------------------------------\n// ★uiオブジェクト UserInterface側のオブジェクト\n//---------------------------------------------------------------------------\n/* extern */\nwindow.ui = {\n\tversion : '0.0.1',\n\n\t/* このサイトで使用するパズルのオブジェクト */\n\tpuzzle    : null,\n\t\n\t/* どの種類のパズルのメニューを表示しているか */\n\tcurrentpid : '',\n\t\n\t/* メンバオブジェクト */\n\tevent     : null,\n\tmenuconfig: null,\n\tmenuarea  : null,\n\ttoolarea  : null,\n\tpopupmgr  : null,\n\tkeypopup  : null,\n\ttimer     : null,\n\t\n\tdebugmode : false,\n\t\n\tenableGetText   : false,\t// FileReader APIの旧仕様でファイルが読めるか\n\tenableReadText  : false,\t// HTML5 FileReader APIでファイルが読めるか\n\treader : null,\t\t\t\t// FileReaderオブジェクト\n\t\n\tenableSaveImage : false,\t// 画像保存が可能か\n\tenableImageType : {},\t\t// 保存可能な画像形式\n\t\n\tenableSaveBlob  : false,\t// saveBlobが使用できるか\n\n\tcallbackComplete : null,\n\n\t//---------------------------------------------------------------------------\n\t// ui.displayAll()     全てのメニュー、ボタン、ラベルに対して文字列を設定する\n\t// ui.setdisplay()     個別のメニュー、ボタン、ラベルに対して文字列を設定する\n\t//---------------------------------------------------------------------------\n\tdisplayAll : function(){\n\t\tui.menuarea.display();\n\t\tui.toolarea.display();\n\t\tui.popupmgr.translate();\n\t\tui.misc.displayDesign();\n\t},\n\tsetdisplay : function(idname){\n\t\tui.menuarea.setdisplay(idname);\n\t\tui.toolarea.setdisplay(idname);\n\t},\n\n\t//---------------------------------------------------------------------------\n\t// ui.customAttr()   エレメントのカスタムattributeの値を返す\n\t//---------------------------------------------------------------------------\n\tcustomAttr : function(el, name){\n\t\tvar value = \"\";\n\t\tif(el.dataset!==void 0){ value = el.dataset[name];}\n\t\t/* IE10, Firefox5, Chrome7, Safari5.1以下のフォールバック */\n\t\telse{\n\t\t\tvar lowername = \"data-\";\n\t\t\tfor(var i=0;i<name.length;i++){\n\t\t\t\tvar ch = name[i] || name.charAt(i);\n\t\t\t\tlowername += ((ch>=\"A\" && ch<=\"Z\") ? (\"-\" + ch.toLowerCase()) : ch);\n\t\t\t}\n\t\t\tvalue = el[lowername] || el.getAttribute(lowername) || \"\";\n\t\t}\n\t\treturn value;\n\t},\n\n\t//----------------------------------------------------------------------\n\t// ui.windowWidth()   ウィンドウの幅を返す\n\t//----------------------------------------------------------------------\n\twindowWidth : function(){\n\t\treturn ((window.innerHeight!==void 0) ? window.innerWidth : _doc.body.clientWidth);\n\t},\n\n\t//---------------------------------------------------------------------------\n\t// ui.adjustcellsize()  resizeイベント時に、pc.cw, pc.chのサイズを(自動)調節する\n\t// ui.getBoardPadding() Canvasと境界線の周りの間にあるpaddingのサイズを求めます\n\t//---------------------------------------------------------------------------\n\tadjustcellsize : function(){\n\t\tvar puzzle = ui.puzzle, pc = puzzle.painter;\n\t\tvar cols = pc.getCanvasCols() + ui.getBoardPadding()*2;\n\t\tvar wwidth = ui.windowWidth()-6, mwidth;\t//  margin/borderがあるので、適当に引いておく\n\t\tvar uiconf = ui.menuconfig;\n\n\t\tvar cellsize, cellsizeval = uiconf.get('cellsizeval');\n\t\tvar cr = {base:1.0,limit:0.40}, ws = {base:0.80,limit:0.96}, ci=[];\n\t\tci[0] = (wwidth*ws.base )/(cellsizeval*cr.base );\n\t\tci[1] = (wwidth*ws.limit)/(cellsizeval*cr.base );\n\t\tci[2] = (wwidth*ws.limit)/(cellsizeval*cr.limit);\n\n\t\t// 横幅いっぱいに広げたい場合\n\t\tif(uiconf.get('fullwidth')){\n\t\t\tmwidth = wwidth*0.98;\n\t\t\tcellsize = (mwidth*0.92)/cols;\n\t\t}\n\t\t// 縮小が必要ない場合\n\t\telse if(!uiconf.get('adjsize') || cols < ci[0]){\n\t\t\tmwidth = wwidth*ws.base-4;\n\t\t\tcellsize = cellsizeval*cr.base;\n\t\t}\n\t\t// ひとまずセルのサイズを変えずにmainの幅を調節する場合\n\t\telse if(cols < ci[1]){\n\t\t\tcellsize = cellsizeval*cr.base;\n\t\t\tmwidth = cellsize*cols;\n\t\t}\n\t\t// base～limit間でサイズを自動調節する場合\n\t\telse if(cols < ci[2]){\n\t\t\tmwidth = wwidth*ws.limit-4;\n\t\t\tcellsize = mwidth/cols; // 外枠ぎりぎりにする\n\t\t}\n\t\t// 自動調整の下限値を超える場合\n\t\telse{\n\t\t\tcellsize = cellsizeval*cr.limit;\n\t\t\tmwidth = cellsize*cols;\n\t\t}\n\n\t\t// mainのサイズ変更\n\t\tif(!pc.outputImage){\n\t\t\tgetEL('main').style.width = ''+(mwidth|0)+'px';\n\t\t}\n\n\t\tpuzzle.setCanvasSizeByCellSize(cellsize);\n\t},\n\tgetBoardPadding : function(){\n\t\tvar puzzle = ui.puzzle, padding = 0;\n\t\tswitch(puzzle.pid){\n\t\t\tcase 'firefly': case 'hashikake': case 'wblink':\n\t\t\tcase 'ichimaga': case 'ichimagam': case 'ichimagax':\n\t\t\t\tpadding = 0.30; break;\n\t\t\t\n\t\t\tcase 'kouchoku': case 'gokigen': case 'wagiri': case 'creek':\n\t\t\t\tpadding = 0.20; break;\n\t\t\t\n\t\t\tcase 'slither': case 'bag': case 'mejilink':\n\t\t\t\tpadding = 0.15; break;\n\t\t\t\n\t\t\tcase 'kinkonkan': case 'building': case 'easyasabc': case 'box':\n\t\t\t\tpadding = 0.05; break;\n\t\t\t\n\t\t\tcase 'bosanowa':\n\t\t\t\tpadding = (ui.menuconfig.get('disptype_bosanowa')!==2?0.50:0.05); break;\n\t\t\t\n\t\t\tdefault: padding = 0.50; break;\n\t\t}\n\t\tif(ui.menuconfig.get('fullwidth')){ padding = 0;}\n\t\treturn padding;\n\t},\n\n\t//--------------------------------------------------------------------------------\n\t// ui.selectStr()  現在の言語に応じた文字列を返す\n\t//--------------------------------------------------------------------------------\n\tselectStr : function(strJP, strEN){\n\t\tif(!strEN){ return strJP;}\n\t\treturn (pzpr.lang==='ja' ? strJP : strEN);\n\t},\n\n\t//---------------------------------------------------------------------------\n\t// ui.getCurrentConfigList() 現在のパズルで有効な設定と設定値を返す\n\t//---------------------------------------------------------------------------\n\tgetCurrentConfigList : function(){\n\t\treturn ui.menuconfig.getList();\n\t},\n\n\t//----------------------------------------------------------------------\n\t// ui.initFileReadMethod() ファイルアクセス関連の処理の初期化を行う\n\t//----------------------------------------------------------------------\n\tinitFileReadMethod : function(){\n\t\t// File Reader (あれば)の初期化処理\n\t\tif(typeof FileReader !== 'undefined'){\n\t\t\tthis.reader = new FileReader();\n\t\t\tthis.reader.onload = function(e){ ui.puzzle.open(e.target.result);};\n\t\t\tthis.enableReadText = true;\n\t\t}\n\t\telse{\n\t\t\tthis.reader = null;\n\t\t\tthis.enableGetText = (typeof FileList !== 'undefined' && typeof File.prototype.getAsText !== 'undefined');\n\t\t}\n\t},\n\n\t//----------------------------------------------------------------------\n\t// ui.initImageSaveMethod() 画像保存関連の処理の初期化を行う\n\t//----------------------------------------------------------------------\n\tinitImageSaveMethod : function(puzzle){\n\t\tif(!!pzpr.Candle.enable.canvas && !!_doc.createElement('canvas').toDataURL){\n\t\t\tthis.enableImageType.png = true;\n\t\t\t\n\t\t\tvar canvas = _doc.createElement('canvas');\n\t\t\tcanvas.width = canvas.height = 1;\n\t\t\tif(canvas.toDataURL('image/gif').match('image/gif'))  { this.enableImageType.gif = true;}\n\t\t\tif(canvas.toDataURL('image/jpeg').match('image/jpeg')){ this.enableImageType.jpeg = true;}\n\t\t\tif(canvas.toDataURL('image/webp').match('image/webp')){ this.enableImageType.webp = true;}\n\t\t}\n\t\tif(!!pzpr.Candle.enable.svg && !!window.btoa){\n\t\t\tthis.enableImageType.svg = true;\n\t\t}\n\t\tif(!!this.enableImageType.png || !!this.enableImageType.svg){\n\t\t\tthis.enableSaveImage = true;\n\t\t}\n\t\t\n\t\tthis.enableSaveBlob = (!!window.navigator.saveBlob);\n\t}\n};\n","// Event.js v3.4.0\n/* global ui:false, _doc:false */\n\n//---------------------------------------------------------------------------\n// ★UIEventsクラス イベント設定の管理を行う\n//---------------------------------------------------------------------------\n// メニュー描画/取得/html表示系\nui.event =\n{\n\tresizetimer : null,\t// resizeタイマー\n\n\tremovers : [],\n\n\t//----------------------------------------------------------------------\n\t// event.addEvent()        addEventListener(など)を呼び出す\n\t//----------------------------------------------------------------------\n\taddEvent : function(el, event, self, callback, capt){\n\t\tthis.removers.push( pzpr.util.addEvent(el, event, self, callback, !!capt) );\n\t},\n\n\t//----------------------------------------------------------------------\n\t// event.removeAllEvents() addEventで登録されたイベントを削除する\n\t//----------------------------------------------------------------------\n\tremoveAllEvents : function(){\n\t\tthis.removers.forEach(function(remover){ remover();});\n\t\tthis.removers=[];\n\t},\n\n\t//---------------------------------------------------------------------------\n\t// event.setWindowEvents()  マウス入力、キー入力以外のイベントの設定を行う\n\t//---------------------------------------------------------------------------\n\tsetWindowEvents : function(){\n\t\t// File API＋Drag&Drop APIの設定\n\t\tif(!!ui.reader){\n\t\t\tvar DDhandler = function(e){\n\t\t\t\tui.reader.readAsText(e.dataTransfer.files[0]);\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t};\n\t\t\tthis.addEvent(window, 'dragover', this, function(e){ e.preventDefault();}, true);\n\t\t\tthis.addEvent(window, 'drop', this, DDhandler, true);\n\t\t}\n\n\t\t// onBlurにイベントを割り当てる\n\t\tthis.addEvent(_doc, 'blur', this, this.onblur_func);\n\n\t\t// onresizeイベントを割り当てる\n\t\tvar evname = (!pzpr.env.OS.iOS ? 'resize' : 'orientationchange');\n\t\tthis.addEvent(window, evname, this, this.onresize_func);\n\n\t\t// onbeforeunloadイベントを割り当てる\n\t\tthis.addEvent(window, 'beforeunload', this, this.onbeforeunload_func);\n\n\t\t// onunloadイベントを割り当てる\n\t\tthis.addEvent(window, 'unload', this, this.onunload_func);\n\n\t\t// エラー表示を消去する\n\t\tthis.addEvent(document.getElementById('quesboard'), 'mousedown', this, function(e){\n\t\t\tui.puzzle.errclear();\n\t\t\te.stopPropagation();\n\t\t});\n\t},\n\n\t//---------------------------------------------------------------------------\n\t// event.onload_func()   ウィンドウを開いた時に呼ばれる関数\n\t// event.onunload_func() ウィンドウをクローズする前に呼ばれる関数\n\t//---------------------------------------------------------------------------\n\tonload_func : function(){\n\t\tui.initFileReadMethod();\n\t\t\n\t\tui.menuconfig.restore();\n\t\t\n\t\tui.listener.setListeners(ui.puzzle);\n\t\t\n\t\tif(pzpr.env.OS.Android){\n\t\t\tui.misc.modifyCSS({'body, .btn':{fontFamily:'Verdana, Arial, sans-serif'}});\n\t\t}\n\t},\n\tonunload_func : function(){\n\t\tui.menuconfig.save();\n\t},\n\n\t//---------------------------------------------------------------------------\n\t// event.onresize_func() ウィンドウリサイズ時に呼ばれる関数\n\t// event.onblur_func()   ウィンドウからフォーカスが離れた時に呼ばれる関数\n\t// event.onbeforeunload_func()  ウィンドウをクローズする前に呼ばれる関数\n\t//---------------------------------------------------------------------------\n\tonresize_func : function(){\n\t\tif(this.resizetimer){ clearTimeout(this.resizetimer);}\n\t\tthis.resizetimer = setTimeout(function(){ ui.adjustcellsize();},250);\n\t},\n\tonblur_func : function(){\n\t\tui.puzzle.key.keyreset();\n\t\tui.puzzle.mouse.mousereset();\n\t},\n\tonbeforeunload_func : function(e){\n\t\tif(ui.puzzle.playeronly || !ui.puzzle.ismodified()){ return;}\n\t\t\n\t\tvar msg = ui.selectStr(\"盤面が更新されています\", \"The board is edited.\");\n\t\te.returnValue = msg;\n\t\treturn msg;\n\t}\n};\n"]}